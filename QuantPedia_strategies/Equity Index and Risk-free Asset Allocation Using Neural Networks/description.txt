No doubt, machine learning algorithms are emerging in the financial markets. A lot of traditional strategies are revisited and modified by some machine learning approach. A popular strategy is to allocate into risky and risk-free assets, where the risky investment is the stock index (a representative of a whole market) and the risk-free asset is a Treasury bill. For efficient allocation, it is necessary to predict future returns.
Traditionally, linear regression models were used to model and predict future returns based on numerous predictors; however, many problems are connected with such a prediction. The models are linear, while the relationships most probably are not linear and linear regressions tend to be overfitted. On the other hand, machine learning algorithms can learn the non-linear dependencies, and the overfitting can be solved by proper training (validation, hyperparameters choosing, etc.). This novel research examines the allocation mentioned above using neural networks – feedforward, Long-Short-Term-Memory (LSTM) and compares it to the more traditional linear approaches. The authors follow the Goyal and Welch (2008) and use variables such as dividend yield, log earning price ratio, dividend payout ratio, book to market ratio, net equity expansion, treasury bill rates, term spread, default yield spread, default return spread, cross-sectional premium, inflation growth, and monthly stock variance.
The neural networks outperform all linear implementations. Moreover, the LSTM seems to be the best model, but that is expectable since the LSTM includes memory units. Therefore, the LSTM can learn long-term temporal dynamics, which simple feedforward neural networks cannot.
Lastly, the paper analyzes longer and shorter rebalancing and holding periods, but we will centre our attention around the shorter timeframes. The reason is that more frequent rebalancing seems to work better with ML methods. The only problem that could arise is the transaction costs, but according to the paper, the strategy is profitable even in the presence of transaction costs.

Fundamental reason
Many criticise machine learning algorithms, labelling them as a black-boxes. Neural networks are not like tree-based models, which are transparent, but that is not a reason to not use them. The reason for the functionality of this strategy is the machine learning approach. Neural networks are not transparent, they are black-boxes, but most importantly, they can learn non-linear and complex relationships. As the research shows, this learning ability is directly translated into better statistical accuracy (compared to linear models). Both the mean squared prediction error and out-of-sample R-squared are significantly better. However, the probably most important aspect is performance, which is also considerably better when neural networks are used.
Additionally, according to the authors, results are robust to various portfolio performance measures, the inclusion of transaction costs, and borrowing and short-selling constraints.

Simple trading strategy
The investment universe consists of S&P500 index and one-period Treasury bill (depends on the holding period). At time t, the strategy maximizes the expected utility over the cumulative portfolio return (equation 8) at time t plus T, where the T is a holding period. The portfolio consists of S&P500 index (risky part) with a weight w and Treasury bill (risk-free part) with a weight of one minus w (equation 9). The weight for the stocks index is winsorized to be between -1 and 2. It is assumed that the investor utilizes the power utility function equal to the cumulative portfolio return raised to the power one minus gamma (coefficient of risk aversion) divided by one minus gamma. The risk aversion coefficient is equal to the four throughout the paper. To compute the expected utility, the strategy utilize the returns predicted by the Long-Short-Term-Memory (LSTM) neural network with 3 recurrent layers with 32-16-8 neurons in each and LSTM cells introduced into the last layer. The LSTM is trained on a 10-year rolling window with following variables: dividend yield, log earning price ratio, dividend payout ratio, book to market ratio, net equity expansion, treasury bill rates, term spread, default yield spread, default return spread, cross-sectional premium, inflation growth, and monthly stock variance (predictors used in the Goyal and Welch (2008)). The holding period is six months, with a rebalancing period of three months.
Lastly, the machine-learning models are sensitive to hyperparameters and validation. The individual implementation largely influences this process; however, the paper’s approach is explained on page 11-12.

Hedge for stocks during bear markets
Partially - It largely depends on the algorithm used. For example, the presented LSTM version seems to be profitable during recession periods (based on Figure 3).