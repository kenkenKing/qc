The authors in this paper provided a framework for the long-term investors to form and manage their portfolios. The created framework uses Reinforcement Learning (RL). Also, explicitly incorporates long (up to 10 years) investment horizon, and low, annual, frequency of portfolio rebalancing. In addition, this framework explicitly incorporates short-medium- and long-term volatility, illiquidity and asset turnover on the portfolio level considerations during training the model.
The objective of the paper was:
1. How should long-term investors form portfolios?
2. How should they adapt to the fact that our world features time-varying expected returns, volatilities, correlations, and a plethora of factors, signals, and strategies?
The used approach follows the literature that draws inferences about optimal portfolio weights without explicitly modeling the underlying return distributions – Brandt (1999), Aït-sahali and Brandt (2001), Brandt and Santa-Clara (2006), Brandt et al. (2009), Chen et al. (2020) and Chatigny et al. (2021).
Modelling objective:
1. The authors condition portfolio weights allocation among asset classes on “plethora of factors, signals, and strategies” or the big data. It was used 153 firm specific characteristics from Jensen et al. (2022) to construct 153 factor-specific features.
2. All short- and long-term investors are cautious about portfolio turnover and trading costs, as ignoring them results in large utility losses (Balduzzi and Lynch (1999)).
This is a high-dimensional problem that could not be solved without recent technological developments. Therefore, the authors used Reinforcement learning (RL) which is to some extent a deep learning alternative to dynamic programming used by the previous literature (Brennan et al. (1997), Lynch (2001))4 in high dimensional space. The economic gains that the authors achieved with multi-horizon RL portfolio management approach with big data were significant. Deep-RL-based portfolio construction created in this paper, directly incorporates multihorizon inter-temporal asset turnover, illiquidity and volatility as penalties, while maximizing mean portfolio return. Consistent with predictable mean reversion in returns argument, the authors also found that the long-term portfolio invests 3 times more in SMB, compared to the short term portfolio. The authors found that short-term investment horizon approach relies on a completely different information set of economic variables compared to the long-horizon.
Based on this paper, the RL approach to portfolio management by long-term investors with multiple institutional and risk constraints is not only the most suitable but most likely the only possible one as an alternative to the standard 50-year old mean-variance optimization portfolio model.
Fundamental reason
The main reason for the functionality of the strategy is the logic behind the proposed framework. The focus is on the framework for the long-term investors to form and manage their portfolios. Proposed framework used Reinforcement Learning (RL) approach. Explicitly incorporates long, up to 10 years, investment horizon, and low, annual, frequency of portfolio rebalancing. Moreover, explicitly incorporates short-medium- and long-term volatility, lliquidity and asset turnover on the portfolio level considerations during training the model.
The authors considered long horizon investor allocating between multiple risk factors. Also, the dynamic turnover and rebalancing strategies of short vs long horizon investors while allocating across multiple risk factors were considered. The long-horizon strategy is more patient in trading and timing factor realizations. It has ten times more (12 vs 120) future time intervals to strategically spread its trades. On the other hand, the shorter horizon causes more aggressive trading every month, and as a result more portfolio volatility. Analyzing the variable/feature importance (RL model logic is based on) the authors found that short term investment horizon consideration and monthly rebalancing uses: co-skewnes, skewness, betas, return volatility, idiosyncratic skewness or reversals as the top predictors, which is also similar to the results in the previous literature – Gu et al. (2020, 2019).

Simple trading strategy
One of the key algorithms in the model architecture used in this paper is Transformer Encoder (TE). TE is a part of sequence representation extraction models (SREM), which till recently was dominated by Long Short-Term Memory (LSTM). Unlike RNNs, and LSTM in particular, TE processes the entire input all at once, without modeling sequential dependencies in the time series. Given the low auto-correlation structure of financial data, e.g. stock returns, TE is perhaps the most suitable for finance applications among all other currently available ML approaches.
The measure of relevant importance, that is the key component of TE and allows differentially weighting the significance of any part of the input data, is based on self-attention mechanism (Vaswani et al. (2017)).
This mechanism is often used in NLP (Natural Language Processing) to identify the similarities among words in the sentence. This similarities are aimed to best describe the object in the sentence. The attention mechanism was used to extract the most relevant representations and signals from time series and cross-section of multiple asset characteristics which best describe and contribute to the best future portfolio performance.
Important: Used TE s different from regular TE in NLP applications!
The basic TE architecture for one asset is shown in the Figure 1. The input are 12 vectors associated with 12 month of look-back window. Each vector contains 153 asset specific characteristic for each month.
1. TE performs sparsity reduction of each vector by reducing its dimensionality to 128.
2. A reduced vector of each month characteristics undergoes embedding with queries, Qxt and keys, Kxt. Queries is a set of vectors that we want to calculate attention for. Keys is a set of vectors that we want to calculate attention against.
3. As a result of dot product multiplication, is obtain set of weights a (also vectors) showing how attended each Query against Keys.
Overall is used multi-head attention with four heads. This means that the Attention module repeats its computations four times in parallel. Four heads are used for robustness.
The overall architecture of the model is illustrated in Figure 2. The model was trained via RL. In RL training, an agent interacts with the environment in a T-period investment game.
Asset classes are commonly used in the literature factors: gross returns of the market (MKT), small-minus-big (SMB), high-minus-low (HML), robust-minus-weak (RMW), and conservative- minus-aggressive (CMA) factors of Fama and French (2015), the momentum (MOM) factor of Carhart (1997), the profitability (ROE) and investment (IA) factors of Hou et al. (2015), and the betting-against-beta (BAB) factor of Frazzini and Pedersen (2014).
The authors downloaded the factors from the corresponding authors’ websites, and then replicate these nine value-weighted portfolios in order to estimate:
1. transaction costs required to trade the stocks comprising these portfolios,
2. portfolio-levels characteristics given the stocks in these portfolios.
Table 1 presents summary statistics of the monthly factor returns. Monthly data cover the historical period from January 1980 to December 2020. The data on individual stock characteristics are from Jensen et al. (2022) and com prise of 153 individual monthly, or quarterly in case of some COMPUSTAT data, stock specific characteristics. Table 1 in Appendix summarizes these variables.
For each factor portfolio were constructed 153 factor characteristics by applying the same weighting scheme to individual stock characteristics that are used for stock returns to construct the factors.
Training.
To train the model, were used the data from January 1980 to December 2004 as first training sample. To start the training for the monthly rebalancing, were randomly draw a month from the training set without replacement. Figure 4 visualizes procedure for the case of monthly rebalancing. Figure 5 demonstrates the training procedure for the annual rebalancing.
OOS Portfolio Performance: Main Results
Table 4 presents the multifactor portfolio performance for the OOS period from January 2005 to December 2020. Depending on the length of holding period, the returns, standard deviations and risk-adjusted portfolio alphas are either monthly, quarterly, semi-annual or annualized. The Alphas are estimated using two specific models. The table presents the multifactor portfolio out-of-sample, OOS, performance by holding period/rebalancing frequencies ranging from 1 month to 1 year. he returns, stan dard deviations and risk-adjusted alphas are scaled to the length of holding periods, while Sharpe ratios are annualized, i.e. the same scale across all frequencies.
Hedge for stocks during bear markets
Yes - The on-line Appendix B of the paper presents factor timing use-cases around the COVID-19 March 2020 market crash and the 2008-2009 financial crisis episode. In both cases the model takes a short position a few months before one of the factors crashes, which further supports its market timing ability.