There is considerable evidence that Machine Learning models generalize better on out of sample tests and are useful in capturing complexities in the asset pricing structure. This is well demonstrated by Gu, Kelly 2020, as well as a plethora of literature on this subject. These models typically take a broad range of features into account, which mimics the factor and alpha research stream that preceded these investigations. These ‘anomalies’ are often referred to as risks that the investor is compensated for in terms of a return that would be arbitraged away under the efficiency assumption. The author of this paper decides to use these anomalies as a way to construct a dependent variable which stands in contrast to the approaches, where this type data is most often included as explanatory variables. Taking the 32 most significant anomalies as has been researched by Hou et al., 2018, the model is looking at U.S. equities and tries to classify whether the stock belongs to the long or the short side of the portfolio. This is an interesting approach as it introduces a unique way to label the stocks depending on how the anomaly ranks the stock. This is a composite score that is the target for learning in the model that is interpreted heuristically as the probability of a stock to be classified in the long side of a portfolio. The training set of this model features a measure of biased expectations. The author constructs this feature based on the behavioral explanation for the possible mispricing in the assets and deploys the Machine Learning approach to do so, finding a statistically significant long-short spread. In essence, the model is fit on the data that captures the effect of a biased investor expectation on the pricing structure of the stock. The paper features several models, contrasting the performance of non-parametric as well as parametric approaches. These models are the Logistic Lasso, Support Vector Machines with linear as well as nonlinear kernels, Random Forest and the Gradient Boosted Decision Tree. The benefits of using these models for the classification tasks is that they suffer less from effects that can cause problems in the estimation of the conditional expectation function. For example, decision tree methods suffer less from multicollinearity than a typical ordinary least squares regression with a similar level of interpretability. Their popularity also stems from the fact that they are naturally designed to combat the typical problems associated with fitting a strategy onto data, specifically that of the look-ahead bias, as the functional estimation is claimed to be often more robust.

Fundamental reason
Ever since the birth of capital markets, pricing anomalies have been a subject of academic research. The training set in this paper tries to aggregate the most significant effects as of the time it was written and tries to address the issue of finding alpha through looking at how these anomalies can increase the probability of the asset being mispriced on the positive or negative side. These are described in Appendix 1 and feature effects such as typical Earnings surprise, Price Momentum, Book-to-market equity and the other usual suspects. In addition to these well-documented effects, a number of other risk premia are estimated from the Consumption CAPM, Fama-French Five-Factor and Leverage risk betas are included in the process of labeling the target variable in the model. The fundamental explanation for them can be found in the seminal paper of Fama and French (2015) and other works such as Lettau and Ludvigson (2001b) or Adrian et al. (2014). The training data rationale hinges on the behavioral explanation that the analysts’ earnings forecast can be viewed as the market’s earnings expectation. These are known to have a typically positive bias on the earnings, which can cause investors to put too much value on the future cash flows, and the result is that the security is overpriced. The inclusion of such feature in the training set could explain events where such events can occur and provide a heuristic for arbitrage or a contrarian strategy. By including a Machine Learning benchmark to construct this feature, the model indirectly conditions on all the macroeconomic, firm-specific and other typical covariates.

Simple trading strategy
The investment universe consists of the common stocks with share codes 10 and 11. Firstly, the 27 anomaly features are created given their descriptions in appendix 2. As an example, decile spreads on the Return on equity is taken and each of the stocks is assigned into a respective decile, featuring the anomaly level for that stock based on this profitability ratio. Then, the risk models are estimated for the remaining six risk premia that are estimated using the Consumption CAPM and the Fama French five-factor model. Extracting the betas from these models complements the data used for labeling that comprises of 32 total anomalies for the first case of the model training in this paper. To construct the feature set, analysts’ earnings expectations are extracted and compared with a separate ML model to mark these expectations to the model as described in appendix 3. The secondary model takes fundamental, macroeconomic and analysts’ earnings forecasts and estimates the biased expectations as the (analyst forecast – forecast of the secondary model)/previous price. This constitutes the target variable. The model used for this secondary model is a Random Forest that predicts an earnings per share for one, two or three quarters ahead. For each month in the training set, the biased expectation is then calculated to obtain the time series used for training the Machine Learning models in the second use case. The target variable is labeled using the simple average of the anomaly scores calculated from the ranks based on the 32 anomalies. These ranks are based on the location of the stock in the decile of the anomaly. The data is then split every month with an 80% training and 20% test split and accuracy is calculated as the models are trained. Five-fold cross-validation is conducted in all the models with optimal parameters as follows. Regularization parameter gamma is set to be 0.3 for RBF SVM and 2 for the Poly SVM. For the tree-based models, depth is decided to be 6 both for Decision Trees and Random Forest models. For the gradient boosted tree model depth is set to be 2 with 0.23 learning rate – alpha. After the models are trained, the probability of a stock being in the long side as defined by the label described earlier is predicted. Based on these probabilities, the stocks are sorted by this implied probability, and the long-short spread is traded by buying the top decile and selling the bottom one. The stocks are value-weighted and rebalanced monthly (we present the average return across all the models). Similarly, the model is retrained for the most recent three years, and the window slides every month.

Hedge for stocks during bear markets
Not known - Paper does not include any information regarding to this topic.