Systematical asset allocation is already well-established among practitioners, and our screener also includes a traditional approach for such a task. Nowadays, machine learning methods are getting more and popular in the finance world. The main benefit is that usually, such algorithms can find more optimal strategies, compared to traditional approaches (for example, fixed moving averages). This novel research has developed artiﬁcial intelligence for adaptive portfolio management by examining the assets for a long time period and by allocation in to diverse, and global asset classes. Recurrent Long short-term memory (LSTM, the main advantage of recurrent neural networks is the ability to “remember” the past) neural network is trained by the usage of historical prices and economic and market data with reduced dimensionality (this can be easily done with principal component analysis), such neural network predicts future returns that are inputs in the Markowitz’s Mean-Variance Optimization (MVO). Such optimization is able to eliminate risks that are not systematic and also determine the optimal distribution of the investments between the different assets – the asset allocation. Simply said, MVO is used for maximizing return for a given risk or minimizing risk for a given return. In theory, such a model with economic and market input features should adapt to changes in the ﬁnancial markets, by regularly adjusting the asset allocation. The research backs the aforementioned theory since the trained model is able to estimate returns for a group of various diversified ETFs, and resulting trading strategy outperforms traditional portfolio management approaches.

Fundamental reason
Markowitz’s Mean-Variance Optimization (MVO) is notoriously known and essential part of modern portfolio theory, where the mean-variance analysis is used to maximise expected return for some given level of risk. On the other hand, Long short-term memory (LSTM) model is not that straightforward. Recurrent networks and especially LSTM models are quite different from the feedforward artificial neural networks. Simply said, LSTM models have hidden state, cell state and forget input and output gates. LSTM uses the cell state as a compact summary of past information, and gates act on the signals they receive, they are used to block or pass on information based on its strength. Therefore, the cells can learn when to allow data to enter, leave or when to delete it, and most importantly, models are able to “remember” history. The main reason for functionality is the complex algorithm that can predict future returns with accuracy that is sufficient for a profitable trading strategy. Additionally, the paper has examined various economic conditions during the backtest and analysed whether the LSTM approach has better performance than benchmarks. Often, the model can outperform other approaches during market falls and crises or recover better than other models (for example European debt crisis, Russian ﬁnancial crisis of December 2014 or China market crash of August 2015, however, for example during Taper Tantrums model was outperformed by benchmark).

Simple trading strategy
The investment universe consists of diversified ETFs for various asset classes (US stock, Developed Market Stocks, Emerging Market Stocks, Dividend Growth Stocks, US Government Bonds, Corporate Bonds, Emerging Market Bonds, Municipal Bonds, TIPS, Real Estate and Natural Resources). Inputs for the LSTM model are Macroeconomic data, Market data and Assets historical data (details about data and sources are presented on page 28).

Firstly, to reduce the dimensionality of the economic and market data, use the Principal Components Analysis (PCA). The dimensionality reduction is used to capture only key economic and market features that are passed along. The market and economic data with reduced dimensionality are then passed to the LSTM neural network, along with the historical prices for the assets. Paper recognizes two LSTM approaches, LSTM1 used the Mean Absolute Error (MAE) loss function, PCA to reduce the dimensionality of the market and macroeconomic data to 70 dimensions, with a layer width of 16 and one hidden layer. LSTM2 experiment also included the Mean Squared Error to observe which loss function would perform better and retained more dimensions from the PCA analysis. LSTM2 used PCA to reduce market and macroeconomic data to 150 dimensions, and the network has three hidden layers with a width of 128 and made use of early stopping. The LSTM2 significantly outperforms LSTM1; therefore, we consider the LSTM2 as a better and more suitable model. The chosen LSTM model is used to predict future returns, which are passed into Mean Variance Optimizer (MVO) to find optimal weights of assets. Minimum weights for asset classes are 0,05 (0,00 for TIPS), and the maximal weights are set to 0,35. The goal of the MVO method is to minimize “weighted” covariance matrix (covariance matrix multiplied from the left and right by the vector of weights with the correct order and transposes) with subject to some constraints (minimal and maximal weights, the sum of weights has to be equal to 1, no short selling), return of the portfolio is found as a sum of weighted returns (or transposed weights multiplied by the vector of returns). Lastly, the training period increased by one month with each prediction and the model was fitted using Adam optimizer. The strategy is rebalanced monthly.

Hedge for stocks during bear markets
Not known - Source and related research papers don’t offer insight into the correlation structure of the proposed trading strategy to equity market risk; therefore, we do not know if this strategy can be used as a hedge/diversification during the time of market crisis.